const soundData = [{"DRH": "p", "PO": "p", "labial": "spread", "manner": "stop", "place": "Bilabial", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "p̓", "PO": "p’", "labial": "spread", "manner": "stop", "place": "Bilabial", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "m", "PO": "m", "labial": "spread", "manner": "stop", "place": "Bilabial", "velum": "nasal", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "m̓ ", "PO": "m’", "labial": "spread", "manner": "stop", "place": "Bilabial", "velum": "nasal", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "t̓ᶿ", "PO": "tth’", "labial": "spread", "manner": "affricate", "place": "Dental", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "θ", "PO": "th", "labial": "spread", "manner": "fricative", "place": "Dental", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "t", "PO": "t", "labial": "spread", "manner": "stop", "place": "Alveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "t̓", "PO": "t’", "labial": "spread", "manner": "stop", "place": "Alveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "c", "PO": "ts", "labial": "spread", "manner": "affricate", "place": "Alveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "c̓", "PO": "ts’", "labial": "spread", "manner": "affricate", "place": "Alveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "s", "PO": "s", "labial": "spread", "manner": "fricative", "place": "Alveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "n", "PO": "n", "labial": "spread", "manner": "resonant", "place": "Alveolar", "velum": "nasal", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "n̓", "PO": "n’", "labial": "spread", "manner": "resonant", "place": "Alveolar", "velum": "nasal", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "/", "PO": "tl", "labial": "spread", "manner": "affricate", "place": "", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "ƛ̓", "PO": "tl’", "labial": "spread", "manner": "affricate", "place": "", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "ł", "PO": "lh", "labial": "spread", "manner": "resonant", "place": "", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "l", "PO": "l", "labial": "spread", "manner": "resonant", "place": "", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "l̓", "PO": "l’", "labial": "spread", "manner": "resonant", "place": "", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "č", "PO": "tsh", "labial": "spread", "manner": "affricate", "place": "Postalveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "š", "PO": "sh", "labial": "spread", "manner": "fricative", "place": "Postalveolar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "y", "PO": "y", "labial": "spread", "manner": "resonant", "place": "Palatal", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "y̓", "PO": "y’", "labial": "spread", "manner": "resonant", "place": "Palatal", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "k", "PO": "k", "labial": "spread", "manner": "stop", "place": "Velar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "x", "PO": "x", "labial": "spread", "manner": "fricative", "place": "Velar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "kʷ", "PO": "kw", "labial": "rounded", "manner": "stop", "place": "Velar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "k̓ʷ", "PO": "kw’", "labial": "rounded", "manner": "stop", "place": "Velar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "xʷ", "PO": "hw", "labial": "rounded", "manner": "fricative", "place": "Velar", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "w", "PO": "w", "labial": "rounded", "manner": "resonant", "place": "Velar", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "w̓", "PO": "w’", "labial": "rounded", "manner": "resonant", "place": "Velar", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "q", "PO": "q", "labial": "spread", "manner": "stop", "place": "Uvular", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "q̓", "PO": "q’", "labial": "spread", "manner": "stop", "place": "Uvular", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "x̌", "PO": "x", "labial": "spread", "manner": "fricative", "place": "Uvular", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "qʷ", "PO": "qw", "labial": "rounded", "manner": "stop", "place": "Uvular", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "q̓ʷ", "PO": "qw’", "labial": "rounded", "manner": "stop", "place": "Uvular", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "x̌ʷ", "PO": "xw", "labial": "rounded", "manner": "fricative", "place": "Uvular", "velum": "oral", "vocalFolds": "voiced", "epiglottis": "glottalized" , "soundfile": ""},{"DRH": "ʔ", "PO": "’", "labial": "spread", "manner": "stop", "place": "Glottal", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""},{"DRH": "h", "PO": "h", "labial": "spread", "manner": "fricative", "place": "Glottal", "velum": "oral", "vocalFolds": "voiceless", "epiglottis": "not-glottalized" , "soundfile": ""}]
var soundTest = soundData.find(sound => sound.DRH === "k")
console.log(soundTest);
console.log(soundTest.DRH);
var dialect="";
const tonguePlace = ["Bilabial","Dental","Alveolar", "Lateral", "Postalveolar","Palatal","Velar","Uvular","Glottal"]
const manners = ["stop", "fricative", "resonant", "affricate"]

function refreshSammy()
{
	doVelum();
	doLips();
	doTongue();
	doVocalFolds();
}

function sameSize(imgID)
{
	var newWidth = 1 * document.getElementById(imgID).width;
	var newHeight = 1 * document.getElementById(imgID).height;
	document.getElementById(imgID).width = newWidth;
	document.getElementById(imgID).height = newHeight;
	document.getElementById(imgID).src += "?r=" + Math.random();
}

function maintainSammy()
{
	sameSize("nasalcavity");
	sameSize("lips");
	sameSize("tongue");
	sameSize("velum");
	sameSize("sagbottom");
}

function hiLite(imgID,imgName) 
{
	var extension="gif";
 	document.images.namedItem(imgID).src = "images/"+imgName + "." + extension; 
 	console.log(imgName + "." + extension);
	sameSize(imgID);
}

function getEpiglottisValue()
{
	var epiglottisValue = "not-glottalized";
	var epiglottisLength = document.samform.glottalizing.length;
	for (lcv=0; lcv < epiglottisLength; lcv++) {
		if (document.samform.glottalizing[lcv].checked) {
			epiglottisValue = document.samform.glottalizing[lcv].value;
			break;
		}
	}
	return epiglottisValue;
}

function doVocalFolds()
{
	if(document.getElementById("voiced").checked){
		if (document.getElementById("not-glottalized").checked) {hiLite("sagbottom", "bottom-voiced-noglottal")}
		if (document.getElementById("glottalized").checked || getPlaceValue() === "Glottal") {hiLite("sagbottom", "bottom-voiced-glottal")}
	}

	else{
		if (document.getElementById("not-glottalized").checked) {hiLite("sagbottom", "bottom-voiceless-noglottal")}
		if (document.getElementById("glottalized").checked || getPlaceValue() === "Glottal") {hiLite("sagbottom", "bottom-voiceless-glottal")}
	}

}


function getTongueValue()
{
	var tongueValue = "00";
	var tongueLength = document.samform.lingual.length;
	for (lcv=0; lcv < tongueLength; lcv++) {
		if (document.samform.lingual[lcv].checked) {
			tongueValue = document.samform.lingual[lcv].value;
			break;
		}
	}
	return tongueValue;
}

function doResonant(){
	doVocalFolds(voiced)
}

function getMannerValue(){
	var tongueValue = "00";
	var tongueLength = document.samform.lingual.length;
	var manner = ""
	for (lcv=0; lcv < tongueLength; lcv++) {
		if (document.samform.lingual[lcv].checked) {
			// console.log(document.samform.lingual[lcv].attr('id'));
			var id = document.samform.lingual[lcv].id;
			// console.log(id);
			var manner = document.getElementById(id).className;			
			console.log(manner);
			break;
		}
	}
	
	if(manner=="resonant"){
		doResonant();
	}

	return manner;
}

function getPlaceValue(){
	var tongueValue = "00";
	var tongueLength = document.samform.lingual.length;
	for (lcv=0; lcv < tongueLength; lcv++) {
		if (document.samform.lingual[lcv].checked) {
			tongueValue = tonguePlace[lcv%8];
			break;
		}
	}
	return tongueValue;
}

function getLipValue(){

	if(document.getElementById("not-labialized").checked){
		return "spread";
	}

	else
	{
		return "rounded";
	}
}

function doLips()
{
	var lipPos = getLipValue();
	var lipValue="lips-" + getLipValue();

	if (getPlaceValue() === "Bilabial" && getMannerValue() !== "fricative"){
		hiLite("lips","lips-closed");
	}	

	else if(getMannerValue() === "fricative" && getPlaceValue() === "Bilabial"){
		hiLite("lips","lips-blfric");
	}

	else if(getMannerValue() === "fricative" && getPlaceValue() === "Dental"){
		hiLite("lips","lips-spread-dfric");
	}
	
	else
	{
		hiLite("lips",lipValue)
	}
}


function doTongue()
{
	var tongueValue=getTongueValue();
	var mannerValue=getMannerValue();
	var tongueSRC="tongue-"+tongueValue;
	hiLite("tongue",tongueSRC);
	doVocalFolds()
	doLips();
	// transcribe();
}


function doVelum()
{
	var velic="oral";
	if (document.getElementById("nasal").checked) {velic="nasal"}
	hiLite("nasalcavity","top-"+velic);
	hiLite("velum","back-"+velic);
	// transcribe();
}


function charSet(content)
{
	document.getElementById("ipaconcat").innerHTML = content;
}

function hintSet(feature, oldFeatureValue, newFeatureValue, symbol)
{
	return "If you change " + oldFeatureValue + " to " + newFeatureValue + " you'll get the sound: " + symbol + ".";
}

function capitalize(word){
	var letter = word.charAt(0).toUpperCase();
	return letter+word.slice(1);
}

function soundExplanation(symbol, dialect, place, manner, glottalization, labialization, voicing)
{
	if(dialect==="DRH"){dialect="hən̓q̓əmin̓əm̓"}else{dialect ="hul’q’umi’num’"}
	console.log(labialization);
	var lips = "";
	if(labialization === "rounded"){lips = "Labialized";}
	if(glottalization === "not-glottalized"){glottalization = "";}else{glottalization = capitalize(glottalization);}
	var definition = symbol.bold() + " is the " + dialect + " symbol for a " + capitalize(voicing) + " " + glottalization + " " + lips + " " + capitalize(place) + " " + capitalize(manner) + ".";
	return definition;
}

function setOrthography(){
	if(document.getElementById("DRH").checked){
		// document.getElementById("DRH").checked=false;
		return "DRH";
	}else if (document.getElementById("PO").checked){
		// document.getElementById("PO").checked=false;
		return "PO";
	}
	// return dialect;
}


const word = "freecodecamp"

const capitalized =
  word.charAt(0).toUpperCase()
  + word.slice(1)

function transcribe()
{
	console.log("doing transcribe");
	var dialect = setOrthography();
	console.log(dialect);
	document.getElementById("hint").innerHTML = "";
	var toprint="/";
	var tongueValue=getTongueValue();
	var glottalizing = "";
	var velic="oral";
	var mannerValue=getMannerValue();
	var placeValue = getPlaceValue();
	if (document.getElementById("nasal").checked) {velic="nasal"}
	var laryngeal="voiceless";
	if (document.getElementById("voiced").checked) {laryngeal="voiced"}
	var lipValue=getLipValue();
	var epiglottisValue="not-glottalized";
	if (document.getElementById("glottalized").checked) {epiglottisValue="glottalized"}

	function findOther(){
		console.log("finding other");
		
		let feature = "";
		let oldFeatureValue = "";
		let newFeatureValue = "";
		let symbol = "";
		let sound;
		// var hint = "The features you selected don't make a sound in "+ dialect ". See what happens if you change one feature.";
		// voicing
		if(soundData.find(sound => sound.labial === lipValue && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue) !== undefined){
			sound = soundData.find(sound => sound.labial === lipValue && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue);
			feature = "voicing";
			if(document.getElementById("voiceless").checked) 
				{
					oldFeatureValue = "voiceless"; newFeatureValue = "voiced";
				} else { oldFeatureValue = "voiced"; newFeatureValue = "voiceless";}
		}

		// glottalizing
		else if (soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.velum === velic && sound.manner === mannerValue && sound.place===placeValue) !== undefined)
		{
			sound = soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.velum === velic && sound.manner === mannerValue && sound.place===placeValue);
			feature = "glottalization";
			if(document.getElementById("not-glottalized").checked) 
			{
				oldFeatureValue = "not glottalized"; newFeatureValue = "glottalized";;
			} else { oldFeatureValue = "glottalized"; newFeatureValue = "not glottalized";}
			
		}

		//velar
		else if (soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.manner === mannerValue && sound.place===placeValue) !== undefined)
		{
			sound = soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.manner === mannerValue && sound.place===placeValue);
			feature = "Velic";
			if(document.getElementById("oral").checked) 
			{
				oldFeatureValue = "oral"; newFeatureValue = "nasal";
			} else { oldFeatureValue = "nasal"; newFeatureValue = "oral";}
		}

		//labial
		else if (soundData.find(sound => sound.vocalFolds === laryngeal && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue) !== undefined)
		{
			sound = soundData.find(sound => sound.vocalFolds === laryngeal && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue);
			feature = "Labialization";
			if(document.getElementById("not-labialized").checked) 
			{
				oldFeatureValue = "not labialized"; newFeatureValue = "labialized";
			} else { oldFeatureValue = "labialized"; newFeatureValue = "not labialized";}
		}

		if(sound!== undefined){
			if(dialect==="DRH"){
				symbol = sound.DRH;
			}

			else{symbol = sound.PO}
		hint += (" " + hintSet(feature, oldFeatureValue, newFeatureValue, symbol));
		}
		
		document.getElementById("hint").innerHTML = hint;
		document.getElementById("hint").innerHTML = "The features you selected don't make a sound in "+ dialect + ". See what happens if you change one feature.";
	}

	console.log(lipValue,laryngeal,velic,epiglottisValue,mannerValue, placeValue);
	console.log(soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue));
	if(soundData.filter(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue));
	{
		var targetSound = soundData.find(sound => sound.labial === lipValue && sound.vocalFolds === laryngeal && sound.velum === velic && sound.epiglottis === epiglottisValue && sound.manner === mannerValue && sound.place===placeValue);
		if (targetSound !== undefined){
			console.log("there is a target sound");
			console.log(targetSound);
			
			if(dialect==="DRH"){
				toprint = targetSound.DRH;
			}
			else{toprint = targetSound.PO}
			charSet(toprint);
		document.getElementById("hint").innerHTML = soundExplanation(toprint, dialect, placeValue, mannerValue, epiglottisValue, lipValue, laryngeal);
		
		}
		else {
			var d="hul’q’umi’num’";
			charSet(" ");
			if(dialect==="DRH"){d = "hən̓q̓əmin̓əm̓";}
			document.getElementById("hint").innerHTML = "The features you selected don't make a sound in "+ d + ". See what happens if you change just one feature.";

			// findOther();
		}
	}
}

function orange(element) {
	document.getElementById(element).style.background = "#ffe4b5";
}

function blue(element) {
	// document.getElementById(element).style.background = "#3a3a40";
	document.getElementById(element).style.background = "#78E1D6";
}

function white(element) {
	document.getElementById(element).style.background = "#ffffff";
}

function oring(element) {
	document.getElementById(element).style.border = "4px solid #ffe4b5";
}

function bring(element) {
	document.getElementById(element).style.border = "4px solid #8a8a90";
}